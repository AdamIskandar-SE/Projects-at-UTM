<!-- public/index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>TTMS - Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css">
    <link rel="stylesheet" href="assets/css/custom-styles.css">
</head>
<body>
    <div id="loginApp"></div>

    <!-- Scripts -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="assets/js/utils.js"></script>
    <script src="../app/src/models/User.js"></script>
    <script src="../app/src/controllers/AuthController.js"></script>
    
    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    username: 'A16CS4016',
                    password: '201608M10112',
                    errorMessage: '',
                    loading: false
                };
            },
            
            methods: {
                async login() {
                    if (!this.username || !this.password) {
                        this.errorMessage = "Please enter both username and password";
                        return;
                    }
                    
                    this.loading = true;
                    this.errorMessage = '';
                    
                    try {
                        const authController = new AuthController();
                        await authController.login(this.username, this.password);
                        window.location.replace("main.html");
                    } catch (error) {
                        this.errorMessage = error.message;
                    } finally {
                        this.loading = false;
                    }
                }
            },
            
            template: `
                <div class="login-container">
                    <h2 class="w3-center w3-text-blue">FC Timetable System</h2>
                    <div class="w3-panel w3-pale-blue">
                        <p>Please login with your UTM credentials</p>
                    </div>
                    
                    <form @submit.prevent="login">
                        <label class="w3-text-blue"><b>Username</b></label>
                        <input class="w3-input w3-border" type="text" v-model="username" required>
                        
                        <label class="w3-text-blue"><b>Password</b></label>
                        <input class="w3-input w3-border" type="password" v-model="password" required>
                        
                        <div v-if="errorMessage" class="w3-panel w3-pale-red">
                            {{ errorMessage }}
                        </div>
                        
                        <div class="w3-center w3-margin-top">
                            <button class="w3-btn w3-blue" type="submit" :disabled="loading">
                                {{ loading ? 'Logging in...' : 'Login' }}
                            </button>
                        </div>
                    </form>
                </div>
            `
        }).mount('#loginApp');
    </script>
</body>
</html>